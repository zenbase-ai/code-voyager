# Task 3 — LLM sub-call wrapper (`claude -p`) + recursion guard

## Goal

Provide a single, safe way to invoke `claude -p` from scripts and prevent hook recursion loops.

## Deliverables

- `src/voyager/llm.py`
  - runs `claude -p "<prompt>" --output-format json`
  - supports a strict “JSON only” mode and optional schema hints
  - timeouts + error handling (return structured error instead of raising in hooks)
- `scripts/lib/claude_print.py` (thin executable wrapper around `src/voyager/llm.py`)
- Recursion guard:
  - Env var: `VOYAGER_FOR_CODE_INTERNAL=1`
  - All hook-invoked scripts: if set, exit 0 without doing work
  - All internal `claude -p` calls: set the env var
- Dogfooding fixtures:
  - `.claude/fixtures/llm/` with at least one “known-good” JSON prompt/response pair for smoke testing parsing behavior (no network required)

## Acceptance criteria

- A script can call the wrapper and reliably parse JSON output.
- Missing `claude` binary does not crash hooks; scripts degrade gracefully.
- Recursion guard prevents infinite hook triggering when scripts themselves invoke `claude -p`.
- The wrapper can be exercised in this repo with a fixture-driven test (no dependency on the real Claude runtime).
